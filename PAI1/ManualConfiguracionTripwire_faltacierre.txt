Vamos a proceder con la configuración de la herramienta Tripwire, ubicada en el directorio /etc/tripwire de
nuestro sistema Ubuntu, donde se ha configurado. Estos son los pasos a seguir, realizados mediante comandos
en un terminal del sistema:

1.- Iniciamos el sistema que gestiona la base de datos.
	sudo tripwire --init

2.- Escribimos la contraseña local, y como resultado observamos que aparecen muchos errores debido a falta
    de directorios o archivos. Para resolverlo, modificaremos el archivo de configuración de Tripwire y 
    regenerar la configuración.

3.- Añadimos a un archivo los ficheros que no existen.
	sudo sh -c "tripwire --check | grep Filename > no-directory.txt"
	
4.- A continuación, los visualizamos.
	cat no-directory.txt

5.- Accedemos al archivo de configuración de Tripwire, para modificarlo.
	sudo nano /etc/tripwire/twpol.txt

6.- En la regla "Boot Stripts", comentamos la siguiente linea.
	(
	  rulename = "Boot Scripts",
   	  severity = $(SIG_HI)
 	)
 	{
         	/etc/init.d             -> $(SEC_BIN) ;
         	#/etc/rc.boot           -> $(SEC_BIN) ;
         	/etc/rcS.d              -> $(SEC_BIN) ;

7.- En la regla "System Boot Changes", otras dos.
	(
   	  rulename = "System boot changes",
   	  severity = $(SIG_HI)
 	)
 	{
         	#/var/lock               -> $(SEC_CONFIG) ;
         	#/var/run                -> $(SEC_CONFIG) ; # daemon PIDs
         	/var/log                -> $(SEC_CONFIG) ;

8.- En la regla "Root config files", comentamos todas estas lineas.
	(
   	  rulename = "Root config files",
   	  severity = 100
 	)
 	{
         	/root                           -> $(SEC_CRIT) ; # Catch all additions to /root
         	#/root/mail                     -> $(SEC_CONFIG) ;
         	#/root/Mail                     -> $(SEC_CONFIG) ;
         	#/root/.xsession-errors         -> $(SEC_CONFIG) ;
         	#/root/.xauth                   -> $(SEC_CONFIG) ;
         	#/root/.tcshrc                  -> $(SEC_CONFIG) ;
         	#/root/.sawfish                 -> $(SEC_CONFIG) ;
         	#/root/.pinerc                  -> $(SEC_CONFIG) ;
         	#/root/.mc                      -> $(SEC_CONFIG) ;
         	#/root/.gnome_private           -> $(SEC_CONFIG) ;
         	#/root/.gnome-desktop           -> $(SEC_CONFIG) ;
         	#/root/.gnome                   -> $(SEC_CONFIG) ;
         	#/root/.esd_auth                        -> $(SEC_CONFIG) ;
         	#/root/.elm                     -> $(SEC_CONFIG) ;
         	#/root/.cshrc                   -> $(SEC_CONFIG) ;
         	/root/.bashrc                   -> $(SEC_CONFIG) ;
         	#/root/.bash_profile            -> $(SEC_CONFIG) ;
         	#/root/.bash_logout             -> $(SEC_CONFIG) ;
         	/root/.bash_history             -> $(SEC_CONFIG) ;
         	#/root/.amandahosts             -> $(SEC_CONFIG) ;
         	#/root/.addressbook.lu          -> $(SEC_CONFIG) ;
         	#/root/.addressbook             -> $(SEC_CONFIG) ;
         	#/root/.Xresources              -> $(SEC_CONFIG) ;
         	#/root/.Xauthority              -> $(SEC_CONFIG) -i ; # Changes Inode number on login
         	#/root/.ICEauthority                -> $(SEC_CONFIG) ;

9.- En la regla "Device and Kernel information", comentamos una linea.
	(
   	  rulename = "Devices & Kernel information",
   	  severity = $(SIG_HI),
 	)
 	{
         /dev            -> $(Device) ;
        #/proc          -> $(Device) ;
	}

10.- Tras realizar estos cambios en el archivo de configuración, guardamos los cambios (Ctrl + O) y 
     salimos del archivo (Ctrl + X).

11.- Regeneramos el archivo tras las modificaciones. Nos pedirán que introduzcamos la 
     contraseña de sitio.
	sudo twadmin -m P /etc/tripwire/twpol.txt

12.- Reiniciamos la base de datos, con el nuevo archivo de politicas.
	sudo tripwire --init

13.- En este punto, podemos comprobar que la herramienta se ha configurado correctamente, para ello
     usamos el comando.
	sudo tripwire --check
     Deberiamos obtener un resultado sin violaciones ni errores.

14.- Vamos a probar si en este punto, detecta errores o modificaciones en directorios. En el directorio
     /home creamos un documento.
	sudo touch /home/Prueba.txt

15.- Lanzamos de nuevo el comando de comprobación, sobre ese directorio.
	sudo tripwire --check /home
     Deberia aparecer una vilación detectada en el directorio, al haber añadido el nuevo archivo.

16.- Para añadir un directorio a controlar mediante la herramienta, hemos de añadir una nueva regla
     al archivo de configuracion de Tripwire. Abrimos el archivo:
	 sudo nano /etc/tripwire/twpol.txt
     Y al final del documento añadimos la nueva regla. Además, es posible indicar que nos comuniquen
     por correo electrónico, si se detecta algún fallo o modificación del directorio que queremos 
     monitorizar. Se realiza mediante el comando emailto, como se ve en este ejemplo:
	#Rule for HomeCheck
	(
	  rulename = "HomeCheck Rule",
	  severity = $(SIG_HI)
	  emailto = emailQueQueramos
	)
	{
		/home	-> $(SEC_CRIT);
	}

17.- Guardamos (Ctrl + O), cerramos el archivo (Ctrl + X) y regeneramos el archivo de configuración.
	sudo twadmin -m P /etc/tripwire/twpol.txt

18.- Ahora reiniciamos la base de datos.
	sudo tripwire --init

19.- Podemos probar la comunicación via e-mail, creando un archivo de nuevo en el directorio controlado, 
     en el caso del ejemplo /home:
	sudo touch /home/Prueba2.txt
     Y usando el comando de check junto con el de reportar via email:
   	sudo tripwire --check --email-report

20.- Deberiamos recibir un correo con un reporte de la monitorización por parte de la herramienta.